<html>
<link rel= "stylesheet" type= "text/css" href= "static/style.css">
<body>
	<script language='javascript' type='text/javascript'>	
		function getNewSongs() {
			clearSongs();
			var ajaxRequest;
				try{
					ajaxRequest = new XMLHttpRequest();
				} catch (e){
					try{
						ajaxRequest = new ActiveXObject('Msxml2.XMLHTTP');
					} catch (e) {
						try{
							ajaxRequest = new ActiveXObject('Microsoft.XMLHTTP');
						} catch (e){
							alert('Your browser broke!');
							return false;
						}
					}
				}
			ajaxRequest.onreadystatechange = function() {
				if(ajaxRequest.readyState == 4) {
					enableVoting();
					document.getElementById("algorithm1").value = ajaxRequest.responseText.split("|||")[0];
					document.getElementById("algorithm2").value = ajaxRequest.responseText.split("|||")[1];
					document.getElementById("song1").innerHTML = ajaxRequest.responseText.split("|||")[2];
					document.getElementById("song2").innerHTML = ajaxRequest.responseText.split("|||")[3];
				}
			}
			ajaxRequest.open('GET', "/get_songs/" + document.getElementById("artist").value,
							true);
			ajaxRequest.send(null);
		}

		function vote(winner) {
			var ajaxRequest;
				try{
					ajaxRequest = new XMLHttpRequest();
				} catch (e){
					try{
						ajaxRequest = new ActiveXObject('Msxml2.XMLHTTP');
					} catch (e) {
						try{
							ajaxRequest = new ActiveXObject('Microsoft.XMLHTTP');
						} catch (e){
							alert('Your browser broke!');
							return false;
						}
					}
				}
			ajaxRequest.onreadystatechange = function() {
				if(ajaxRequest.readyState == 4) {
					disableVoting();
				}
			}
			ajaxRequest.open('GET', 
							"/vote_for/"
								+ document.getElementById("algorithm1").value + "/"
								+ document.getElementById("algorithm2").value + "/"
								+ winner + "/"
								+ document.getElementById("artist").value,
							true);
			ajaxRequest.send(null);
		}

		function disableVoting() {
			var buttons = document.getElementsByClassName('vote-button');
			var i;
			for (i = 0; i < buttons.length; i++) {
				var button = buttons[i];
				button.disabled = true;
				button.innerHTML= "Thanks!";
			} 
		}

		function enableVoting() {
			var buttons = document.getElementsByClassName('vote-button');
			var i;
			for (i = 0; i < buttons.length; i++) {
				var button = buttons[i];
				button.disabled = false;
				button.innerHTML= "This One's Better";
			} 
		}

		function clearSongs() {
			document.getElementById("song1").innerHTML = "<h2>Thinking!</h2>"
			document.getElementById("song2").innerHTML = "<h2>Thinking!</h2>"
		}		

	</script>

	<div id="header">
		<h1 align="center">Welcome to </h1>
		<h1 align="center" style="color:#551A8B">THE ARENA</h1>
		<h2>Two verses. One victor. Who will win? You decide!</h2>
			<button id="load-new-verses-button" onclick="getNewSongs()">Load New Verses</button>
			<a class="button" href="/">Choose a new artist</a>
			<br><br>
	</div>
	<div id="main-container">
		<h3>Learning from Taylor Swift</h3>
		<input type=hidden id="artist" value="Taylor-Swift">
		<input type=hidden id="algorithm1" value="">
		<input type=hidden id="algorithm2" value="">
		<div class="song-container">
			<button class="vote-button" type="button" onclick="vote(1)" disabled=true>This One's Better</button>
			<br><br>
			<div id="song1">
			</div>
		</div>
		<div class="song-container">
			<button class="vote-button" type="button" onclick="vote(2)" disabled=true>This One's Better</button>
			<br><br>
			<div id="song2">
			</div>
		</div>
		<div id="spotify-player">
			<iframe src="https://embed.spotify.com/?uri=spotify%3Auser%3A1250251216%3Aplaylist%3A21v37QniMoKRzJ2OWGLAr4" height="380" frameborder="0" allowtransparency="true"></iframe>
		</div>
	</div>
</body>
</html>